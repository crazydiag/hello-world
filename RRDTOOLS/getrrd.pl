#!/usr/bin/perl

my %servers = (
	'192.168.197.242' => ['supportcomm','.1.3.6.1.4.1.2021.8.1.101'],
	'195.211.131.171' => ['supportcomm','.1.3.6.1.4.1.2021.8.1.101'],
	'195.211.131.172' => ['supportcomm','.1.3.6.1.4.1.2021.8.1.101'],
	
	'192.168.198.202' => ['supportcomm','.1.3.6.1.4.1.2021.8.1.101'],
	'192.168.198.203' => ['supportcomm','.1.3.6.1.4.1.2021.8.1.101'],
	'192.168.198.204' => ['supportcomm','.1.3.6.1.4.1.2021.8.1.101'],
	
	'192.168.196.135' => ['wwwc1.astr','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'192.168.196.136' => ['wwwc1.astr','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'192.168.196.137' => ['wwwc1.astr','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'192.168.196.138' => ['wwwc1.astr','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'192.168.196.139' => ['wwwc1.astr','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'192.168.196.140' => ['wwwc1.astr','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'192.168.196.141' => ['wwwc1.astr','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'192.168.196.142' => ['wwwc1.astr','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'192.168.196.180' => ['wwwc1.astr','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'192.168.196.181' => ['wwwc1.astr','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'192.168.196.171' => ['wwwc1.astr','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'192.168.196.172' => ['wwwc1.astr','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'192.168.196.173' => ['wwwc1.astr','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	
	'log.base.a1.pvt' => ['A1cbt2','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'log.sh1.a1.pvt' => ['A1cbt2','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'log.sh2.a1.pvt' => ['A1cbt2','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'log.sh3.a1.pvt' => ['A1cbt2','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'log.sh4.a1.pvt' => ['A1cbt2','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'log.sh5.a1.pvt' => ['A1cbt2','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'log.sh6.a1.pvt' => ['A1cbt2','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'log.sh7.a1.pvt' => ['A1cbt2','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'log.sh8.a1.pvt' => ['A1cbt2','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'backup.base.a1.pvt' => ['A1cbt2','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'backup.sh1.a1.pvt' => ['A1cbt2','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'backup.sh2.a1.pvt' => ['A1cbt2','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'backup.sh3.a1.pvt' => ['A1cbt2','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'backup.sh4.a1.pvt' => ['A1cbt2','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'backup.sh5.a1.pvt' => ['A1cbt2','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'backup.sh6.a1.pvt' => ['A1cbt2','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'backup.sh7.a1.pvt' => ['A1cbt2','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
	'backup.sh8.a1.pvt' => ['A1cbt2','.1.3.6.1.4.1.8072.1.3.2.3.1.2.5.115.116.97.116.115'],
);
foreach my $ip (keys(%servers)) {
	my $comm = $servers{$ip}[0] ;
	my $oid = $servers{$ip}[1] ;
	print $comm . " " . $oid . "\n" ;
	my $out = `snmpwalk -v2c -Onvq -c $comm $ip $oid` ;
	my @ar = split /\n/, $out ;
	foreach my $line (@ar) {
		chomp $line ;
		my @arr = split /:/, $line ;
		my $name = shift @arr ;
		my $type = shift @arr ;
		print "$name $type\n" ;
		while ( my $id = shift @arr ) {
			my $val = shift @arr ;
			print " $id $val\n" ;
			my $file = "$ip.$name.$id.rrd" ;
			$file =~ s/\//_/g ;
			if ( ! -e "rrd/$file" ) {
				`rrdtool create "rrd/$file" --start NOW-3600s --step 60 DS:val:$type:600:U:U RRA:MAX:0.5:1:10080 RRA:MAX:0.5:10:4320 RRA:MAX:0.5:60:8760 RRA:MAX:0.5:300:8760 RRA:AVERAGE:0.5:1:10080 RRA:AVERAGE:0.5:10:4320 RRA:AVERAGE:0.5:60:8760 RRA:AVERAGE:0.5:300:8760` ;
			}
			`rrdtool update "rrd/$file" N:$val` ;
		}

	}
}

